metadata:
  name: "Allowed Ingress Settings (Cloud Run)"
  id: "CCOE_GCP_CLOUDRUN_INGRESS_1"
  category: "security"
  severity: "HIGH"
  description: "Ensure Cloud Run services use restricted ingress settings, allowing only internal traffic or internal plus load balancing."

definition:
  cond_type: "attribute"
  resource_types:
    - "google_cloud_run_v2_service"
  attribute: "ingress"
  operator: "within"
  value:
    - "INGRESS_TRAFFIC_INTERNAL_ONLY"
    - "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
