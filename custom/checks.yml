metadata:
  name: "Ensure Disable Audit Logging Exemption"
  id: "CCOE_GCP_DISABLE_AUDIT_LOGGING_EXEMPTION"
  category: "security"
  severity: "HIGH"
  description: "Ensure that no members are exempted from audit logging in IAM Audit Config."

definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "google_organization_iam_audit_config"
        - "google_folder_iam_audit_config"
        - "google_project_iam_audit_config"
      attribute: "audit_log_config.exempted_members"
      operator: "not_exists"
    - cond_type: "attribute"
      resource_types:
        - "google_organization_iam_audit_config"
        - "google_folder_iam_audit_config"
        - "google_project_iam_audit_config"
      attribute: "audit_log_config.exempted_members"
      operator: "is_empty"
