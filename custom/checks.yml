metadata:
  name: "Disable External IPv6 Usage on VPC Subnetworks"
  id: "CCOE_GCP_DISABLE_EXTERNAL_IPV6"
  category: "networking"
  severity: "HIGH"
  description: "Ensure external IPv6 access is disabled."

definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "google_compute_subnetwork"
      attribute: "ipv6_access_type"
      operator: "not_exists"
    - cond_type: "attribute"
      resource_types:
        - "google_compute_subnetwork"
      attribute: "ipv6_access_type"
      operator: "not_equals"
      value: EXTERNAL
