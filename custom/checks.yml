metadata:
  name: "Disable Global VM Serial Port Access"
  id: "CCOE_GCP_DISABLE_VM_SERIAL_PORT"
  category: "security"
  severity: "HIGH"
  description: "Ensure VM serial port access is disabled by setting `serial-port-enable=false` in metadata."

definition:
  or:
   - cond_type: "attribute"
     resource_types:
       - "google_compute_instance" 
     attribute: "metadata.serial-port-enable"
     operator: "not_exists"
   - cond_type: "attribute"
     resource_types:
       - "google_compute_instance" 
     attribute: "metadata.serial-port-enable"
     operator: "equals"
     value: false

     
