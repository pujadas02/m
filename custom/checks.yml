metadata:
  name: "Disallow Custom Service Account on Cloud Build Triggers"
  id: "CUSTOM_NO_CUSTOM_SA_CLOUDBUILD_TRIGGER"
  category: "security"
  severity: "HIGH"
  description: "Ensure Cloud Build uses the default service account by disallowing custom service accounts in triggers."

definition:
  or:
    - cond_type: "resource"
      resource_types:
        - "google_cloudbuild_trigger"
      operator: "not_exists"
    - cond_type: "attribute"
      resource_types:
        - "google_cloudbuild_trigger"
      attribute: "service_account"
      operator: "not_exists"
