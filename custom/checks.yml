metadata:
  name: "Disable VPC Internal IPv6 Usage"
  id: "CCOE_GCP_DISABLE_VPC_INTERNAL_IPV6"
  category: "networking"
  severity: "HIGH"
  description: "Ensure that VPC subnets do not have internal IPv6 enabled to disable internal IPv6 usage."

definition:
  and:
    - or:
        - cond_type: "attribute"
          resource_types:    
            - "google_compute_subnetwork"
          attribute: "ipv6_access_type"
          operator: "not_exists"
        - cond_type: "attribute"
          resource_types:
            - "google_compute_subnetwork"
          attribute: "ipv6_access_type"
          operator: "not_equals"
          value: "INTERNAL"
    - or:
        - cond_type: "attribute"
          resource_types:
            - "google_compute_network"
          attribute: "enable_ula_internal_ipv6"
          operator: "not_exists"
        - cond_type: "attribute"
          resource_types:
            - "google_compute_network"
          attribute: "enable_ula_internal_ipv6"
          operator: "not_equals"
          value: true


