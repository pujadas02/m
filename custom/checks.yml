metadata:
  name: "Restrict VM IP Forwarding"
  id: "CKV_CUSTOM_GCP_010"
  category: "gcp"
  severity: "HIGH"
  description: "Ensure IP forwarding on VM is disabled to prevent spoofing and unauthorized routing."

definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - google_compute_instance
      attribute: "can_ip_forward"
      operator: "not_exists"
    - cond_type: "attribute"
      resource_types:
        - google_compute_instance
      attribute: "can_ip_forward"
      operator: "equals"
      value: false
