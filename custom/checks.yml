metadata:
  name: "Require Disabled Key Versions Before Destruction"
  id: "CCOE_GCP_KMS_DISABLE_BEFORE_DESTROY"
  category: "encryption"
  severity: "HIGH"
  description: "Ensure that Google Cloud KMS key versions are set to `DISABLED` before being destroyed."

definition:
  cond_type: "attribute"
  resource_types:
    - "google_kms_crypto_key_version"
  attribute: "state"
  operator: "equals"
  value: "DISABLED"
